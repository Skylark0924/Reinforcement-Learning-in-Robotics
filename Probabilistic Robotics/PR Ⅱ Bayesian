## Probabilistic in Robotics â…¡: Bayesian Estimation/Inference

**ç»Ÿè®¡æŽ¨æ–­**æ—¨åœ¨æ ¹æ®å¯è§‚å¯Ÿåˆ°çš„äº‹ç‰©æ¥äº†è§£ä¸å¯è§‚å¯Ÿåˆ°çš„äº‹ç‰©ã€‚å³ï¼Œç»Ÿè®¡æŽ¨æ–­æ˜¯åŸºäºŽä¸€ä¸ªæ€»ä½“æˆ–ä¸€äº›æ ·æœ¬ä¸­çš„æŸäº›è§‚å¯Ÿå˜é‡ï¼ˆé€šå¸¸æ˜¯å½±å“ï¼‰å¾—å‡ºç»“è®ºçš„è¿‡ç¨‹ï¼Œä¾‹å¦‚å…³äºŽæ€»ä½“æˆ–æ ·æœ¬ä¸­æŸäº›æ½œåœ¨å˜é‡ï¼ˆé€šå¸¸æ˜¯åŽŸå› ï¼‰çš„å‡†æ—¶ä¼°è®¡ã€ç½®ä¿¡åŒºé—´æˆ–åŒºé—´ä¼°è®¡ç­‰ã€‚

### è´å¶æ–¯ä¼°è®¡/æŽ¨æ–­

æˆ‘ä»¬åœ¨ä¸Šä¸€ç« å¼ºè°ƒè´å¶æ–¯æ´¾ä¸Žé¢‘çŽ‡æ´¾ä¸–ç•Œè§‚å·®å¼‚çš„æ—¶å€™ï¼Œç€é‡æè¿°äº†è´å¶æ–¯æ´¾å¯¹äºŽ**å‚æ•°æ˜¯éšæœºå˜é‡**çš„çœ‹æ³•ï¼Œç„¶è€Œæœ€å¤§åŽéªŒæ¦‚çŽ‡ä¼°è®¡MAPå¾—åˆ°çš„å€¼å´æ˜¯ä¸ªå®šå€¼ $\theta^*$ï¼Œæ˜¯å‚æ•°è¿™ä¸ªå˜é‡æ¦‚çŽ‡åˆ†å¸ƒä¸­çš„ä¸€ä¸ªç‰¹å®šç‚¹ã€‚è¿™å¬èµ·æ¥æ²¡æœ‰å¾ˆå¥½çš„è´¯å½»è´å¶æ–¯æ´¾çš„ç²¾ç¥žã€‚

**è´å¶æ–¯ä¼°è®¡**æ˜¯ä¸ªæ›´å½»åº•çš„è´å¶æ–¯æ´¾ï¼Œæ˜¯MAPçš„è¿›ä¸€æ­¥æ‰©å±•ã€‚ä¸å†ä¼°è®¡ä¸€ä¸ªç‰¹å®šçš„å‚æ•° $\theta$ï¼Œè€Œæ˜¯è¦ä¼°è®¡å®ƒçš„**åˆ†å¸ƒ**ã€‚

åœ¨è´å¶æ–¯ä¼°è®¡ä¸­ï¼Œæ ·æœ¬ç»éªŒåˆ†å¸ƒ $P(X)$ ä¸å†è¢«çœç•¥ï¼Œå› ä¸ºè¿™ä¸å†æ˜¯ä¸“é—¨å¯¹å‚æ•° $\theta$ çš„ä¼°è®¡ã€‚

ç¦»æ•£åž‹è´å¶æ–¯å…¬å¼ï¼š
$$
P(\theta | X)=\frac{P(X | \theta) P(\theta)}{P(X)}
$$
è¿žç»­åž‹è´å¶æ–¯å…¬å¼ï¼š
$$
P(\theta | X)=\frac{P(X | \theta) P(\theta)}{\int_{\Theta} P(X | \theta) P(\theta) d \theta}
$$
å¾ˆæ˜Žæ˜¾ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½å¤„ç†çš„å…¬å¼ï¼Œå°¤å…¶æ˜¯è¿žç»­åž‹çš„åˆ†æ¯ï¼ˆ**å½’ä¸€åŒ–å› å­**ï¼‰ $P(X)=\int_{\Theta} P(X | \theta) P(\theta) d \theta$ (å…¨æ¦‚çŽ‡å…¬å¼å±•å¼€ï¼Œè¿˜è®°å¾—å—ðŸ§)

### æ‰‹ç®—è´å¶æ–¯ä¼°è®¡

æˆ‘ä»¬å…ˆè¯•ç€åšåšï¼Œè¿˜æ˜¯ä¹‹å‰çš„æ‰”ç¡¬å¸ï¼Œä¸è¿‡æ ·æœ¬å˜äº†ç‚¹ï¼Œæ­£å…­åå››ï¼š

ä»¥ä¸‹å†…å®¹æ¥è‡ª[è´å¶æ–¯ä¼°è®¡ã€æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€æœ€å¤§åŽéªŒæ¦‚çŽ‡ä¼°è®¡](https://link.zhihu.com/?target=http%3A//noahsnail.com/2018/05/17/2018-05-17-%E8%B4%9D%E5%8F%B6%E6%96%AF%E4%BC%B0%E8%AE%A1%E3%80%81%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1%E3%80%81%E6%9C%80%E5%A4%A7%E5%90%8E%E9%AA%8C%E6%A6%82%E7%8E%87%E4%BC%B0%E8%AE%A1/)

ä½¿ç”¨å…±è½­å…ˆéªŒåˆ†å¸ƒï¼Œå°±å¯ä»¥æ›´å¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚äºŒé¡¹åˆ†å¸ƒå‚æ•°çš„å…±è½­å…ˆéªŒæ˜¯Betaåˆ†å¸ƒï¼Œç”±äºŽ Î¸ çš„ä¼¼ç„¶å‡½æ•°æœä»ŽäºŒé¡¹åˆ†å¸ƒï¼Œå› æ­¤åœ¨è´å¶æ–¯ä¼°è®¡ä¸­ï¼Œå‡è®¾ Î¸ çš„å…ˆéªŒåˆ†å¸ƒæœä»Ž $P(\theta) \sim \operatorname{Beta}(\alpha, \beta)$ï¼ŒBetaåˆ†å¸ƒçš„æ¦‚çŽ‡å¯†åº¦å…¬å¼ä¸ºï¼š
$$
f(x ; \alpha, \beta)=\frac{1}{B(\alpha, \beta)} x^{\alpha-1}(1-x)^{\beta-1}
$$
å› æ­¤ï¼Œè´å¶æ–¯å…¬å¼å¯å†™ä½œï¼š
$$
\begin{aligned}
P(\theta | X) &=\frac{P(X | \theta) P(\theta)}{\int_{\Theta} P(X | \theta) P(\theta) d \theta} \\
&=\frac{\theta^{6}(1-\theta)^{4} \frac{\theta^{2-1}(1-\theta)^{\beta-1}}{B(\alpha, \beta)}}{\int_{\Theta} \theta^{6}(1-\theta)^{4} \frac{\theta^{\alpha-1}(1-\theta)^{\beta-1}}{B(\alpha, \beta)} d \theta} \\
&=\frac{\theta^{\alpha+6-1}(1-\theta)^{\beta+4-1}}{\int_{\Theta} \theta^{\alpha+6-1}(1-\theta)^{\beta+4-1} d \theta} \\
&=\frac{\theta^{\alpha+6-1}(1-\theta)^{\beta+4-1}}{B(\alpha+6-1, \beta+4-1)} \\
&=\operatorname{Beta}(\theta | \alpha+6-1, \beta+4-1) \\
&=\operatorname{Beta}(\theta | \alpha+6, \beta+4)
\end{aligned}
$$
ä»Žä¸Šé¢çš„å…¬å¼å¯ä»¥çœ‹å‡ºï¼Œ$P(\theta | X) \sim \operatorname{Beta}(\theta | \alpha+6, \beta+4)$ã€‚å…¶ä¸­ B å‡½æ•°ï¼Œä¹Ÿç§°Betaå‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–å¸¸é‡ï¼Œç”¨æ¥ä½¿æ•´ä¸ªæ¦‚çŽ‡çš„ç§¯åˆ†ä¸º1ã€‚$Beta(Î¸|Î±+6,Î²+4)$å°±æ˜¯è´å¶æ–¯ä¼°è®¡çš„ç»“æžœã€‚

å¦‚æžœä½¿ç”¨è´å¶æ–¯ä¼°è®¡å¾—åˆ°çš„ Î¸ åˆ†å¸ƒå­˜åœ¨ä¸€ä¸ªæœ‰é™å‡å€¼ï¼Œåˆ™å¯ä»¥ç”¨åŽéªŒåˆ†å¸ƒçš„æœŸæœ›ä½œä¸º Î¸ çš„ä¼°è®¡å€¼ã€‚å‡è®¾$Î±=3,Î²=3$ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…ˆéªŒåˆ†å¸ƒä¼šåœ¨0.5å¤„å–å¾—æœ€å¤§å€¼ï¼Œåˆ™$P(Î¸|X)âˆ¼Beta(Î¸|9,7)$ï¼ŒBeta(Î¸|9,7)çš„æ›²çº¿å¦‚ä¸‹å›¾ï¼š

![Beta(9,7)](http://noahsnail.com/images/blog/Beta_9_7.png)

ä»Žä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨$Î±=3,Î²=3$çš„æƒ…å†µä¸‹ï¼ŒÎ¸çš„ä¼°è®¡å€¼ $\hat{\theta}$ åº”è¯¥åœ¨0.6é™„è¿‘ã€‚æ ¹æ®Betaåˆ†å¸ƒçš„æ•°å­¦æœŸæœ›å…¬å¼ $E(Î¸)=\dfrac{Î±}{Î±+Î²}$ ï¼Œæˆ‘ä»¬å¯ä»¥å’ŒMAPä¸€æ ·æ±‚å‡ºä¸€ä¸ªå‚æ•°çš„ç‰¹å€¼ï¼š
$$
\hat{\theta}=\int_{\Theta} \theta P(\theta | X) d \theta=E(\theta)=\frac{\alpha}{\alpha+\beta}=\frac{9}{9+7}=0.5625
$$
**æ±‚è§£æ­¥éª¤ï¼š**

- ç¡®å®šå‚æ•°çš„ä¼¼ç„¶å‡½æ•°
- ç¡®å®šå‚æ•°çš„å…ˆéªŒåˆ†å¸ƒï¼Œåº”æ˜¯åŽéªŒåˆ†å¸ƒçš„å…±è½­å…ˆéªŒ
- ç¡®å®šå‚æ•°çš„åŽéªŒåˆ†å¸ƒå‡½æ•°
- æ ¹æ®è´å¶æ–¯å…¬å¼æ±‚è§£å‚æ•°çš„åŽéªŒåˆ†å¸ƒ



### å¯¹æµ‹è¯•é›†çš„ä¼°è®¡

è¿™ä¸ªåŠŸèƒ½æ˜¯è´å¶æ–¯ä¼°è®¡ç‹¬æœ‰çš„ã€‚è´å¶æ–¯ä¼°è®¡è¦è§£å†³çš„ä¸æ˜¯å¦‚ä½•ä¼°è®¡å‚æ•°ï¼Œè€Œæ˜¯ç”¨æ¥ä¼°è®¡æ–°æµ‹é‡æ•°æ®å‡ºçŽ°çš„æ¦‚çŽ‡ï¼Œå¯¹äºŽæ–°å‡ºçŽ°çš„æ•°æ® $\tilde x$ ï¼š
$$
P(\tilde{x} | X)=\int_{\Theta} P(\tilde{x} | \theta) P(\theta | X) d \theta=\int_{\Theta} P(\tilde{x} | \theta) \frac{P(X | \theta) P(\theta)}{P(X)} d \theta
$$


**é‚£ä¹ˆå®žé™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•è®¡ç®—è´å¶æ–¯ä¼°è®¡å‘¢ï¼Ÿ**

- åŸºäºŽ**é‡‡æ ·**çš„**é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡ç½—**(Markov Chain Monte Carloï¼Œç®€ç§°MCMC)æ–¹æ³•
- åŸºäºŽ**è¿‘ä¼¼**çš„**å˜åˆ†æŽ¨æ–­**(Variational Inferenceï¼Œç®€ç§°VI)æ–¹æ³•

æœ¬æ–‡ä¸»è¦ä»‹ç»MCMCæ–¹æ³•ï¼Œå…¶ä½™çš„ä¼šåœ¨åŽç»­æ–‡ç« å‡ºçŽ°ã€‚

### é‡‡æ · â€”â€” ä¸€ç§è¿‘ä¼¼æŠ€æœ¯

å½“æˆ‘ä»¬éœ€è¦ä»¥è¾ƒå°çš„ä»£ä»·è¿‘ä¼¼è®¸å¤šé¡¹çš„å’Œæˆ–æŸä¸ªç§¯åˆ†æ—¶ï¼Œ**é‡‡æ ·**æ˜¯ä¸€ç§å¾ˆçµæ´»ä¸”æ˜Žæ™ºçš„é€‰æ‹©ã€‚**æ‰€ä»¥è¿™ä¸åªæ˜¯è´å¶æ–¯æŽ¨æ–­ç‰¹æœ‰çš„æ–¹æ³•ã€‚**

#### é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡æ´› MCMC

å…ˆæ¥çœ‹çœ‹è¿™ä¸ªåå­—ï¼š

- è’™ç‰¹å¡æ´›ï¼šæŒ‡é‡‡æ ·çš„ç›®çš„
- é©¬å°”å¯å¤«é“¾ï¼šæŒ‡å¦‚ä½•èŽ·å¾—è¿™äº›æ ·æœ¬

![img](./PR â…¢ Bayesian_MCMC.assets/1_3nBb4AqcriLcENdpBp4fpQ@2x.png)

ä¸ºäº†é¿å…å¤„ç†æ£˜æ‰‹çš„åŽéªŒåˆ†å¸ƒè®¡ç®—ï¼Œæˆ‘ä»¬ä»Žåˆ†å¸ƒä¸­é‡‡æ ·ï¼Œå¹¶ç”¨è¿™äº›æ ·æœ¬æ¥è®¡ç®—åˆ†å¸ƒçš„ç»Ÿè®¡å‚æ•°ã€‚

**é‚£ä¹ˆMCMCåˆ°åº•æ˜¯ä»€ä¹ˆæ€è·¯å‘¢ï¼Ÿ**

1. å»ºç«‹ä¸€ä¸ªé©¬å°”ç§‘å¤«é“¾ï¼Œä»Žå…¶å¹³ç¨³åˆ†å¸ƒä¸­èŽ·å¾—æ ·æœ¬ï¼›
2. ä»Žé©¬å°”å¯å¤«é“¾ä¸­æ¨¡æ‹Ÿéšæœºçš„çŠ¶æ€åºåˆ—ï¼Œè¯¥åºåˆ—è¶³å¤Ÿé•¿ï¼Œèƒ½å¤Ÿï¼ˆå‡ ä¹Žï¼‰è¾¾åˆ°ç¨³æ€ï¼›
3. ä¿ç•™ç”Ÿæˆçš„ä¸€äº›çŠ¶æ€ä½œä¸ºæ ·æœ¬

![img](./PR â…¢ Bayesian_MCMC.assets/1_AZBh2kDanLoTFmb3yzErGQ@2x.png)

> æ˜¯ä¸æ˜¯è¿˜æ˜¯ä¸€è„¸æ‡µï¼Œåˆ«æ€¥ï¼Œæ…¢æ…¢æ¥ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥åˆ†æžã€‚
>
> ç‚¹ä¸ªèµžå•Šäº²ï¼Œå†™çš„å¾ˆç´¯çš„ã€‚

**1. é©¬å°”ç§‘å¤«é“¾æ€Žä¹ˆå»ºï¼Ÿ**

é©¬å°”å¯å¤«é“¾æˆ‘ä»¬åšå¼ºåŒ–å­¦ä¹ çš„éƒ½ç†Ÿæ‚‰ï¼Œæœ€å¸¸ç”¨çš„æ€§è´¨å°±æ˜¯**é©¬å°”å¯å¤«æ€§ï¼ˆæ— åŽæ•ˆæ€§ï¼‰**ã€‚ä½†æ˜¯è·Ÿæˆ‘ä»¬çš„çº¿æ€§é“¾ä¸åŒï¼Œè¿™é‡Œæ˜¯å®Œæ•´çš„æœ‰å‘å›¾ã€‚

MCMCçš„é©¬å°”ç§‘å¤«é“¾æŒ‡çš„æ˜¯**å»ºç«‹ä¸‹ä¸€æ—¶åˆ»çš„æ ·æœ¬çš„é‡‡æ ·ä¸Žå½“å‰æ—¶åˆ»çš„æ ·æœ¬ä¹‹é—´çš„å…³ç³» â€”â€”â€”â€” è½¬ç§»æ¦‚çŽ‡çŸ©é˜µ** $P_{ij}(x_{t+1}|x_t)$ï¼Œ$P_{ij}$ ä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨äº†å˜é‡Xä»ŽçŠ¶æ€iè½¬ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€jçš„æ¦‚çŽ‡ã€‚

é©¬å°”ç§‘å¤«é“¾å¦ä¸€ä¸ªç¥žå¥‡çš„æ€§è´¨ â€”â€”â€”â€” **æ”¶æ•›æ€§**ï¼šå¯¹äºŽéžå‘¨æœŸçš„é©¬å°”å¯å¤«é“¾æ¥è¯´ï¼ˆéžå‘¨æœŸçš„æ„æ€å°±æ˜¯çŠ¶æ€è½¬ç§»ä¸ä¼šå­˜åœ¨é—­çŽ¯ï¼Œå³æ°¸è¿œåªåœ¨å‡ ä¸ªæœ‰é™çš„çŠ¶æ€ä¹‹é—´ç»•åœˆå­ï¼‰ï¼Œå¦‚æžœä»»æ„ä¸¤ä¸ªçŠ¶æ€éƒ½æ˜¯è¿žé€šçš„ï¼Œï¼ˆå³ä¸ä¼šå­˜åœ¨æŸä¸ªçŠ¶æ€æ— æ³•è½¬ç§»åˆ°å¦ä¸€ä¸ªçŠ¶æ€ï¼‰ï¼Œé‚£ä¹ˆç»™å®šä¸€ä¸ªåˆå§‹çš„æ¦‚çŽ‡åˆ†å¸ƒæ ·æœ¬ï¼Œé€šè¿‡æˆ‘çŠ¶æ€è½¬ç§»çŸ©é˜µçš„ä¸€ç³»åˆ—è½¬æ¢ï¼Œéƒ½ä¼šæ”¶æ•›åˆ°æŸä¸ªç¨³å®šçš„æ¦‚çŽ‡åˆ†å¸ƒï¼Œè¿™ä¸ªç¨³å®šçš„æ¦‚çŽ‡åˆ†å¸ƒä¸Žåˆå§‹æ¦‚çŽ‡æ— å…³ã€‚

![img](https://pic2.zhimg.com/80/v2-8b78f1035471eab24c809d6fb7dc1b01_1440w.png)

**ä»Žæ•°å­¦è§’åº¦çœ‹**ï¼šä»¥ä»»æ„çš„åˆå§‹æ ·æœ¬ $x_0$ å¼€å§‹ï¼Œæ ¹æ®é©¬å°”å¯å¤«é“¾çš„æ”¶æ•›æ€§è´¨ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´çš„è½¬ç§»æ¦‚çŽ‡çš„è¿žä¹˜åŽï¼Œå‡è®¾ä¸ºnæ¬¡ï¼Œxçš„é‡‡æ ·æ¦‚çŽ‡éƒ½ä¼šæ”¶æ•›åˆ°ä¸€ä¸ª**å¹³ç¨³åˆ†å¸ƒ**ï¼Œè®¾ä¸º $\pi(x)$ï¼Œå³åŽç»­çš„æ‰€æœ‰æ ·æœ¬å‡æœä»Žè¿™ä¸ªæ¦‚çŽ‡åˆ†å¸ƒ $\pi(x)$ã€‚
$$
\begin{aligned}
\pi_{t+1}\left(x^{*}\right)=& \int_{x} \pi_{t}(x) P\left(x^{*} | x\right) d x \\
& t>n
\end{aligned}
$$


## Rreference

1. [Bayesian inference problem, MCMC and variational inference](https://towardsdatascience.com/bayesian-inference-problem-mcmc-and-variational-inference-25a8aa9bce29)